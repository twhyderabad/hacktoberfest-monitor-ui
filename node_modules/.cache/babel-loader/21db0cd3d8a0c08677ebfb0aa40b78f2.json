{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireWildcard = require(\"@babel/runtime-corejs2/helpers/interopRequireWildcard\");\n\nvar _interopRequireDefault = require(\"@babel/runtime-corejs2/helpers/interopRequireDefault\");\n\nvar _Object$defineProperty = require(\"@babel/runtime-corejs2/core-js/object/define-property\");\n\n_Object$defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nexports[\"default\"] = void 0;\n\nvar _keys = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/object/keys\"));\n\nvar _objectWithoutProperties2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/objectWithoutProperties\"));\n\nvar _objectSpread3 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/objectSpread\"));\n\nvar _parseInt2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/parse-int\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/toConsumableArray\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/createClass\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/getPrototypeOf\"));\n\nvar _assertThisInitialized2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/assertThisInitialized\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/inherits\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime-corejs2/helpers/defineProperty\"));\n\nvar _isArray = _interopRequireDefault(require(\"@babel/runtime-corejs2/core-js/array/is-array\"));\n\nvar _AddButton = _interopRequireDefault(require(\"../AddButton\"));\n\nvar _IconButton = _interopRequireDefault(require(\"../IconButton\"));\n\nvar _react = _interopRequireWildcard(require(\"react\"));\n\nvar _reactLifecyclesCompat = require(\"react-lifecycles-compat\");\n\nvar _includes = _interopRequireDefault(require(\"core-js/library/fn/array/includes\"));\n\nvar types = _interopRequireWildcard(require(\"../../types\"));\n\nvar _UnsupportedField = _interopRequireDefault(require(\"./UnsupportedField\"));\n\nvar _utils = require(\"../../utils\");\n\nvar _shortid = _interopRequireDefault(require(\"shortid\"));\n\nfunction ArrayFieldTitle(_ref) {\n  var TitleField = _ref.TitleField,\n      idSchema = _ref.idSchema,\n      title = _ref.title,\n      required = _ref.required;\n\n  if (!title) {\n    return null;\n  }\n\n  var id = \"\".concat(idSchema.$id, \"__title\");\n  return _react[\"default\"].createElement(TitleField, {\n    id: id,\n    title: title,\n    required: required\n  });\n}\n\nfunction ArrayFieldDescription(_ref2) {\n  var DescriptionField = _ref2.DescriptionField,\n      idSchema = _ref2.idSchema,\n      description = _ref2.description;\n\n  if (!description) {\n    return null;\n  }\n\n  var id = \"\".concat(idSchema.$id, \"__description\");\n  return _react[\"default\"].createElement(DescriptionField, {\n    id: id,\n    description: description\n  });\n} // Used in the two templates\n\n\nfunction DefaultArrayItem(props) {\n  var btnStyle = {\n    flex: 1,\n    paddingLeft: 6,\n    paddingRight: 6,\n    fontWeight: \"bold\"\n  };\n  return _react[\"default\"].createElement(\"div\", {\n    key: props.key,\n    className: props.className\n  }, _react[\"default\"].createElement(\"div\", {\n    className: props.hasToolbar ? \"col-xs-9\" : \"col-xs-12\"\n  }, props.children), props.hasToolbar && _react[\"default\"].createElement(\"div\", {\n    className: \"col-xs-3 array-item-toolbox\"\n  }, _react[\"default\"].createElement(\"div\", {\n    className: \"btn-group\",\n    style: {\n      display: \"flex\",\n      justifyContent: \"space-around\"\n    }\n  }, (props.hasMoveUp || props.hasMoveDown) && _react[\"default\"].createElement(_IconButton[\"default\"], {\n    icon: \"arrow-up\",\n    className: \"array-item-move-up\",\n    tabIndex: \"-1\",\n    style: btnStyle,\n    disabled: props.disabled || props.readonly || !props.hasMoveUp,\n    onClick: props.onReorderClick(props.index, props.index - 1)\n  }), (props.hasMoveUp || props.hasMoveDown) && _react[\"default\"].createElement(_IconButton[\"default\"], {\n    icon: \"arrow-down\",\n    className: \"array-item-move-down\",\n    tabIndex: \"-1\",\n    style: btnStyle,\n    disabled: props.disabled || props.readonly || !props.hasMoveDown,\n    onClick: props.onReorderClick(props.index, props.index + 1)\n  }), props.hasRemove && _react[\"default\"].createElement(_IconButton[\"default\"], {\n    type: \"danger\",\n    icon: \"remove\",\n    className: \"array-item-remove\",\n    tabIndex: \"-1\",\n    style: btnStyle,\n    disabled: props.disabled || props.readonly,\n    onClick: props.onDropIndexClick(props.index)\n  }))));\n}\n\nfunction DefaultFixedArrayFieldTemplate(props) {\n  return _react[\"default\"].createElement(\"fieldset\", {\n    className: props.className,\n    id: props.idSchema.$id\n  }, _react[\"default\"].createElement(ArrayFieldTitle, {\n    key: \"array-field-title-\".concat(props.idSchema.$id),\n    TitleField: props.TitleField,\n    idSchema: props.idSchema,\n    title: props.uiSchema[\"ui:title\"] || props.title,\n    required: props.required\n  }), (props.uiSchema[\"ui:description\"] || props.schema.description) && _react[\"default\"].createElement(\"div\", {\n    className: \"field-description\",\n    key: \"field-description-\".concat(props.idSchema.$id)\n  }, props.uiSchema[\"ui:description\"] || props.schema.description), _react[\"default\"].createElement(\"div\", {\n    className: \"row array-item-list\",\n    key: \"array-item-list-\".concat(props.idSchema.$id)\n  }, props.items && props.items.map(DefaultArrayItem)), props.canAdd && _react[\"default\"].createElement(_AddButton[\"default\"], {\n    className: \"array-item-add\",\n    onClick: props.onAddClick,\n    disabled: props.disabled || props.readonly\n  }));\n}\n\nfunction DefaultNormalArrayFieldTemplate(props) {\n  return _react[\"default\"].createElement(\"fieldset\", {\n    className: props.className,\n    id: props.idSchema.$id\n  }, _react[\"default\"].createElement(ArrayFieldTitle, {\n    key: \"array-field-title-\".concat(props.idSchema.$id),\n    TitleField: props.TitleField,\n    idSchema: props.idSchema,\n    title: props.uiSchema[\"ui:title\"] || props.title,\n    required: props.required\n  }), (props.uiSchema[\"ui:description\"] || props.schema.description) && _react[\"default\"].createElement(ArrayFieldDescription, {\n    key: \"array-field-description-\".concat(props.idSchema.$id),\n    DescriptionField: props.DescriptionField,\n    idSchema: props.idSchema,\n    description: props.uiSchema[\"ui:description\"] || props.schema.description\n  }), _react[\"default\"].createElement(\"div\", {\n    className: \"row array-item-list\",\n    key: \"array-item-list-\".concat(props.idSchema.$id)\n  }, props.items && props.items.map(function (p) {\n    return DefaultArrayItem(p);\n  })), props.canAdd && _react[\"default\"].createElement(_AddButton[\"default\"], {\n    className: \"array-item-add\",\n    onClick: props.onAddClick,\n    disabled: props.disabled || props.readonly\n  }));\n}\n\nfunction generateRowId() {\n  return _shortid[\"default\"].generate();\n}\n\nfunction generateKeyedFormData(formData) {\n  return !(0, _isArray[\"default\"])(formData) ? [] : formData.map(function (item) {\n    return {\n      key: generateRowId(),\n      item: item\n    };\n  });\n}\n\nfunction keyedToPlainFormData(keyedFormData) {\n  return keyedFormData.map(function (keyedItem) {\n    return keyedItem.item;\n  });\n}\n\nvar ArrayField =\n/*#__PURE__*/\nfunction (_Component) {\n  (0, _inherits2[\"default\"])(ArrayField, _Component);\n\n  function ArrayField(props) {\n    var _this;\n\n    (0, _classCallCheck2[\"default\"])(this, ArrayField);\n    _this = (0, _possibleConstructorReturn2[\"default\"])(this, (0, _getPrototypeOf2[\"default\"])(ArrayField).call(this, props));\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"_getNewFormDataRow\", function () {\n      var _this$props = _this.props,\n          schema = _this$props.schema,\n          _this$props$registry = _this$props.registry,\n          registry = _this$props$registry === void 0 ? (0, _utils.getDefaultRegistry)() : _this$props$registry;\n      var definitions = registry.definitions;\n      var itemSchema = schema.items;\n\n      if ((0, _utils.isFixedItems)(schema) && (0, _utils.allowAdditionalItems)(schema)) {\n        itemSchema = schema.additionalItems;\n      }\n\n      return (0, _utils.getDefaultFormState)(itemSchema, undefined, definitions);\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"onAddClick\", function (event) {\n      event.preventDefault();\n      var onChange = _this.props.onChange;\n      var newKeyedFormDataRow = {\n        key: generateRowId(),\n        item: _this._getNewFormDataRow()\n      };\n      var newKeyedFormData = [].concat((0, _toConsumableArray2[\"default\"])(_this.state.keyedFormData), [newKeyedFormDataRow]);\n\n      _this.setState({\n        keyedFormData: newKeyedFormData\n      }, function () {\n        return onChange(keyedToPlainFormData(newKeyedFormData));\n      });\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"onAddIndexClick\", function (index) {\n      return function (event) {\n        if (event) {\n          event.preventDefault();\n        }\n\n        var onChange = _this.props.onChange;\n        var newKeyedFormDataRow = {\n          key: generateRowId(),\n          item: _this._getNewFormDataRow()\n        };\n        var newKeyedFormData = (0, _toConsumableArray2[\"default\"])(_this.state.keyedFormData);\n        newKeyedFormData.splice(index, 0, newKeyedFormDataRow);\n\n        _this.setState({\n          keyedFormData: newKeyedFormData\n        }, function () {\n          return onChange(keyedToPlainFormData(newKeyedFormData));\n        });\n      };\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"onDropIndexClick\", function (index) {\n      return function (event) {\n        if (event) {\n          event.preventDefault();\n        }\n\n        var onChange = _this.props.onChange;\n        var keyedFormData = _this.state.keyedFormData; // refs #195: revalidate to ensure properly reindexing errors\n\n        var newErrorSchema;\n\n        if (_this.props.errorSchema) {\n          newErrorSchema = {};\n          var errorSchema = _this.props.errorSchema;\n\n          for (var i in errorSchema) {\n            i = (0, _parseInt2[\"default\"])(i);\n\n            if (i < index) {\n              newErrorSchema[i] = errorSchema[i];\n            } else if (i > index) {\n              newErrorSchema[i - 1] = errorSchema[i];\n            }\n          }\n        }\n\n        var newKeyedFormData = keyedFormData.filter(function (_, i) {\n          return i !== index;\n        });\n\n        _this.setState({\n          keyedFormData: newKeyedFormData\n        }, function () {\n          return onChange(keyedToPlainFormData(newKeyedFormData), newErrorSchema);\n        });\n      };\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"onReorderClick\", function (index, newIndex) {\n      return function (event) {\n        if (event) {\n          event.preventDefault();\n          event.target.blur();\n        }\n\n        var onChange = _this.props.onChange;\n        var newErrorSchema;\n\n        if (_this.props.errorSchema) {\n          newErrorSchema = {};\n          var errorSchema = _this.props.errorSchema;\n\n          for (var i in errorSchema) {\n            if (i == index) {\n              newErrorSchema[newIndex] = errorSchema[index];\n            } else if (i == newIndex) {\n              newErrorSchema[index] = errorSchema[newIndex];\n            } else {\n              newErrorSchema[i] = errorSchema[i];\n            }\n          }\n        }\n\n        var keyedFormData = _this.state.keyedFormData;\n\n        function reOrderArray() {\n          // Copy item\n          var _newKeyedFormData = keyedFormData.slice(); // Moves item from index to newIndex\n\n\n          _newKeyedFormData.splice(index, 1);\n\n          _newKeyedFormData.splice(newIndex, 0, keyedFormData[index]);\n\n          return _newKeyedFormData;\n        }\n\n        var newKeyedFormData = reOrderArray();\n\n        _this.setState({\n          keyedFormData: newKeyedFormData\n        }, function () {\n          return onChange(keyedToPlainFormData(newKeyedFormData), newErrorSchema);\n        });\n      };\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"onChangeForIndex\", function (index) {\n      return function (value, errorSchema) {\n        var _this$props2 = _this.props,\n            formData = _this$props2.formData,\n            onChange = _this$props2.onChange;\n        var newFormData = formData.map(function (item, i) {\n          // We need to treat undefined items as nulls to have validation.\n          // See https://github.com/tdegrunt/jsonschema/issues/206\n          var jsonValue = typeof value === \"undefined\" ? null : value;\n          return index === i ? jsonValue : item;\n        });\n        onChange(newFormData, errorSchema && _this.props.errorSchema && (0, _objectSpread3[\"default\"])({}, _this.props.errorSchema, (0, _defineProperty2[\"default\"])({}, index, errorSchema)));\n      };\n    });\n    (0, _defineProperty2[\"default\"])((0, _assertThisInitialized2[\"default\"])(_this), \"onSelectChange\", function (value) {\n      _this.props.onChange(value);\n    });\n    var _formData = props.formData;\n\n    var _keyedFormData = generateKeyedFormData(_formData);\n\n    _this.state = {\n      keyedFormData: _keyedFormData\n    };\n    return _this;\n  }\n\n  (0, _createClass2[\"default\"])(ArrayField, [{\n    key: \"isItemRequired\",\n    value: function isItemRequired(itemSchema) {\n      if ((0, _isArray[\"default\"])(itemSchema.type)) {\n        // While we don't yet support composite/nullable jsonschema types, it's\n        // future-proof to check for requirement against these.\n        return !(0, _includes[\"default\"])(itemSchema.type, \"null\");\n      } // All non-null array item types are inherently required by design\n\n\n      return itemSchema.type !== \"null\";\n    }\n  }, {\n    key: \"canAddItem\",\n    value: function canAddItem(formItems) {\n      var _this$props3 = this.props,\n          schema = _this$props3.schema,\n          uiSchema = _this$props3.uiSchema;\n\n      var _getUiOptions = (0, _utils.getUiOptions)(uiSchema),\n          addable = _getUiOptions.addable;\n\n      if (addable !== false) {\n        // if ui:options.addable was not explicitly set to false, we can add\n        // another item if we have not exceeded maxItems yet\n        if (schema.maxItems !== undefined) {\n          addable = formItems.length < schema.maxItems;\n        } else {\n          addable = true;\n        }\n      }\n\n      return addable;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props4 = this.props,\n          schema = _this$props4.schema,\n          uiSchema = _this$props4.uiSchema,\n          idSchema = _this$props4.idSchema,\n          _this$props4$registry = _this$props4.registry,\n          registry = _this$props4$registry === void 0 ? (0, _utils.getDefaultRegistry)() : _this$props4$registry;\n      var definitions = registry.definitions;\n\n      if (!schema.hasOwnProperty(\"items\")) {\n        return _react[\"default\"].createElement(_UnsupportedField[\"default\"], {\n          schema: schema,\n          idSchema: idSchema,\n          reason: \"Missing items definition\"\n        });\n      }\n\n      if ((0, _utils.isFixedItems)(schema)) {\n        return this.renderFixedArray();\n      }\n\n      if ((0, _utils.isFilesArray)(schema, uiSchema, definitions)) {\n        return this.renderFiles();\n      }\n\n      if ((0, _utils.isMultiSelect)(schema, definitions)) {\n        return this.renderMultiSelect();\n      }\n\n      return this.renderNormalArray();\n    }\n  }, {\n    key: \"renderNormalArray\",\n    value: function renderNormalArray() {\n      var _this2 = this;\n\n      var _this$props5 = this.props,\n          schema = _this$props5.schema,\n          uiSchema = _this$props5.uiSchema,\n          formData = _this$props5.formData,\n          errorSchema = _this$props5.errorSchema,\n          idSchema = _this$props5.idSchema,\n          name = _this$props5.name,\n          required = _this$props5.required,\n          disabled = _this$props5.disabled,\n          readonly = _this$props5.readonly,\n          autofocus = _this$props5.autofocus,\n          _this$props5$registry = _this$props5.registry,\n          registry = _this$props5$registry === void 0 ? (0, _utils.getDefaultRegistry)() : _this$props5$registry,\n          onBlur = _this$props5.onBlur,\n          onFocus = _this$props5.onFocus,\n          idPrefix = _this$props5.idPrefix,\n          rawErrors = _this$props5.rawErrors;\n      var title = schema.title === undefined ? name : schema.title;\n      var ArrayFieldTemplate = registry.ArrayFieldTemplate,\n          definitions = registry.definitions,\n          fields = registry.fields,\n          formContext = registry.formContext;\n      var TitleField = fields.TitleField,\n          DescriptionField = fields.DescriptionField;\n      var itemsSchema = (0, _utils.retrieveSchema)(schema.items, definitions);\n      var arrayProps = {\n        canAdd: this.canAddItem(formData),\n        items: this.state.keyedFormData.map(function (keyedItem, index) {\n          var key = keyedItem.key,\n              item = keyedItem.item;\n          var itemSchema = (0, _utils.retrieveSchema)(schema.items, definitions, item);\n          var itemErrorSchema = errorSchema ? errorSchema[index] : undefined;\n          var itemIdPrefix = idSchema.$id + \"_\" + index;\n          var itemIdSchema = (0, _utils.toIdSchema)(itemSchema, itemIdPrefix, definitions, item, idPrefix);\n          return _this2.renderArrayFieldItem({\n            key: key,\n            index: index,\n            canMoveUp: index > 0,\n            canMoveDown: index < formData.length - 1,\n            itemSchema: itemSchema,\n            itemIdSchema: itemIdSchema,\n            itemErrorSchema: itemErrorSchema,\n            itemData: item,\n            itemUiSchema: uiSchema.items,\n            autofocus: autofocus && index === 0,\n            onBlur: onBlur,\n            onFocus: onFocus\n          });\n        }),\n        className: \"field field-array field-array-of-\".concat(itemsSchema.type),\n        DescriptionField: DescriptionField,\n        disabled: disabled,\n        idSchema: idSchema,\n        uiSchema: uiSchema,\n        onAddClick: this.onAddClick,\n        readonly: readonly,\n        required: required,\n        schema: schema,\n        title: title,\n        TitleField: TitleField,\n        formContext: formContext,\n        formData: formData,\n        rawErrors: rawErrors,\n        registry: registry\n      }; // Check if a custom render function was passed in\n\n      var Component = uiSchema[\"ui:ArrayFieldTemplate\"] || ArrayFieldTemplate || DefaultNormalArrayFieldTemplate;\n      return _react[\"default\"].createElement(Component, arrayProps);\n    }\n  }, {\n    key: \"renderMultiSelect\",\n    value: function renderMultiSelect() {\n      var _this$props6 = this.props,\n          schema = _this$props6.schema,\n          idSchema = _this$props6.idSchema,\n          uiSchema = _this$props6.uiSchema,\n          formData = _this$props6.formData,\n          disabled = _this$props6.disabled,\n          readonly = _this$props6.readonly,\n          required = _this$props6.required,\n          label = _this$props6.label,\n          placeholder = _this$props6.placeholder,\n          autofocus = _this$props6.autofocus,\n          onBlur = _this$props6.onBlur,\n          onFocus = _this$props6.onFocus,\n          _this$props6$registry = _this$props6.registry,\n          registry = _this$props6$registry === void 0 ? (0, _utils.getDefaultRegistry)() : _this$props6$registry,\n          rawErrors = _this$props6.rawErrors;\n      var items = this.props.formData;\n      var widgets = registry.widgets,\n          definitions = registry.definitions,\n          formContext = registry.formContext;\n      var itemsSchema = (0, _utils.retrieveSchema)(schema.items, definitions, formData);\n      var enumOptions = (0, _utils.optionsList)(itemsSchema);\n\n      var _getUiOptions$enumOpt = (0, _objectSpread3[\"default\"])({}, (0, _utils.getUiOptions)(uiSchema), {\n        enumOptions: enumOptions\n      }),\n          _getUiOptions$enumOpt2 = _getUiOptions$enumOpt.widget,\n          widget = _getUiOptions$enumOpt2 === void 0 ? \"select\" : _getUiOptions$enumOpt2,\n          options = (0, _objectWithoutProperties2[\"default\"])(_getUiOptions$enumOpt, [\"widget\"]);\n\n      var Widget = (0, _utils.getWidget)(schema, widget, widgets);\n      return _react[\"default\"].createElement(Widget, {\n        id: idSchema && idSchema.$id,\n        multiple: true,\n        onChange: this.onSelectChange,\n        onBlur: onBlur,\n        onFocus: onFocus,\n        options: options,\n        schema: schema,\n        registry: registry,\n        value: items,\n        disabled: disabled,\n        readonly: readonly,\n        required: required,\n        label: label,\n        placeholder: placeholder,\n        formContext: formContext,\n        autofocus: autofocus,\n        rawErrors: rawErrors\n      });\n    }\n  }, {\n    key: \"renderFiles\",\n    value: function renderFiles() {\n      var _this$props7 = this.props,\n          schema = _this$props7.schema,\n          uiSchema = _this$props7.uiSchema,\n          idSchema = _this$props7.idSchema,\n          name = _this$props7.name,\n          disabled = _this$props7.disabled,\n          readonly = _this$props7.readonly,\n          autofocus = _this$props7.autofocus,\n          onBlur = _this$props7.onBlur,\n          onFocus = _this$props7.onFocus,\n          _this$props7$registry = _this$props7.registry,\n          registry = _this$props7$registry === void 0 ? (0, _utils.getDefaultRegistry)() : _this$props7$registry,\n          rawErrors = _this$props7.rawErrors;\n      var title = schema.title || name;\n      var items = this.props.formData;\n      var widgets = registry.widgets,\n          formContext = registry.formContext;\n\n      var _getUiOptions2 = (0, _utils.getUiOptions)(uiSchema),\n          _getUiOptions2$widget = _getUiOptions2.widget,\n          widget = _getUiOptions2$widget === void 0 ? \"files\" : _getUiOptions2$widget,\n          options = (0, _objectWithoutProperties2[\"default\"])(_getUiOptions2, [\"widget\"]);\n\n      var Widget = (0, _utils.getWidget)(schema, widget, widgets);\n      return _react[\"default\"].createElement(Widget, {\n        options: options,\n        id: idSchema && idSchema.$id,\n        multiple: true,\n        onChange: this.onSelectChange,\n        onBlur: onBlur,\n        onFocus: onFocus,\n        schema: schema,\n        title: title,\n        value: items,\n        disabled: disabled,\n        readonly: readonly,\n        formContext: formContext,\n        autofocus: autofocus,\n        rawErrors: rawErrors\n      });\n    }\n  }, {\n    key: \"renderFixedArray\",\n    value: function renderFixedArray() {\n      var _this3 = this;\n\n      var _this$props8 = this.props,\n          schema = _this$props8.schema,\n          uiSchema = _this$props8.uiSchema,\n          formData = _this$props8.formData,\n          errorSchema = _this$props8.errorSchema,\n          idPrefix = _this$props8.idPrefix,\n          idSchema = _this$props8.idSchema,\n          name = _this$props8.name,\n          required = _this$props8.required,\n          disabled = _this$props8.disabled,\n          readonly = _this$props8.readonly,\n          autofocus = _this$props8.autofocus,\n          _this$props8$registry = _this$props8.registry,\n          registry = _this$props8$registry === void 0 ? (0, _utils.getDefaultRegistry)() : _this$props8$registry,\n          onBlur = _this$props8.onBlur,\n          onFocus = _this$props8.onFocus,\n          rawErrors = _this$props8.rawErrors;\n      var title = schema.title || name;\n      var items = this.props.formData;\n      var ArrayFieldTemplate = registry.ArrayFieldTemplate,\n          definitions = registry.definitions,\n          fields = registry.fields,\n          formContext = registry.formContext;\n      var TitleField = fields.TitleField;\n      var itemSchemas = schema.items.map(function (item, index) {\n        return (0, _utils.retrieveSchema)(item, definitions, formData[index]);\n      });\n      var additionalSchema = (0, _utils.allowAdditionalItems)(schema) ? (0, _utils.retrieveSchema)(schema.additionalItems, definitions, formData) : null;\n\n      if (!items || items.length < itemSchemas.length) {\n        // to make sure at least all fixed items are generated\n        items = items || [];\n        items = items.concat(new Array(itemSchemas.length - items.length));\n      } // These are the props passed into the render function\n\n\n      var arrayProps = {\n        canAdd: this.canAddItem(items) && additionalSchema,\n        className: \"field field-array field-array-fixed-items\",\n        disabled: disabled,\n        idSchema: idSchema,\n        formData: formData,\n        items: this.state.keyedFormData.map(function (keyedItem, index) {\n          var key = keyedItem.key,\n              item = keyedItem.item;\n          var additional = index >= itemSchemas.length;\n          var itemSchema = additional ? (0, _utils.retrieveSchema)(schema.additionalItems, definitions, item) : itemSchemas[index];\n          var itemIdPrefix = idSchema.$id + \"_\" + index;\n          var itemIdSchema = (0, _utils.toIdSchema)(itemSchema, itemIdPrefix, definitions, item, idPrefix);\n          var itemUiSchema = additional ? uiSchema.additionalItems || {} : (0, _isArray[\"default\"])(uiSchema.items) ? uiSchema.items[index] : uiSchema.items || {};\n          var itemErrorSchema = errorSchema ? errorSchema[index] : undefined;\n          return _this3.renderArrayFieldItem({\n            key: key,\n            index: index,\n            canRemove: additional,\n            canMoveUp: index >= itemSchemas.length + 1,\n            canMoveDown: additional && index < items.length - 1,\n            itemSchema: itemSchema,\n            itemData: item,\n            itemUiSchema: itemUiSchema,\n            itemIdSchema: itemIdSchema,\n            itemErrorSchema: itemErrorSchema,\n            autofocus: autofocus && index === 0,\n            onBlur: onBlur,\n            onFocus: onFocus\n          });\n        }),\n        onAddClick: this.onAddClick,\n        readonly: readonly,\n        required: required,\n        schema: schema,\n        uiSchema: uiSchema,\n        title: title,\n        TitleField: TitleField,\n        formContext: formContext,\n        rawErrors: rawErrors\n      }; // Check if a custom template template was passed in\n\n      var Template = uiSchema[\"ui:ArrayFieldTemplate\"] || ArrayFieldTemplate || DefaultFixedArrayFieldTemplate;\n      return _react[\"default\"].createElement(Template, arrayProps);\n    }\n  }, {\n    key: \"renderArrayFieldItem\",\n    value: function renderArrayFieldItem(props) {\n      var key = props.key,\n          index = props.index,\n          _props$canRemove = props.canRemove,\n          canRemove = _props$canRemove === void 0 ? true : _props$canRemove,\n          _props$canMoveUp = props.canMoveUp,\n          canMoveUp = _props$canMoveUp === void 0 ? true : _props$canMoveUp,\n          _props$canMoveDown = props.canMoveDown,\n          canMoveDown = _props$canMoveDown === void 0 ? true : _props$canMoveDown,\n          itemSchema = props.itemSchema,\n          itemData = props.itemData,\n          itemUiSchema = props.itemUiSchema,\n          itemIdSchema = props.itemIdSchema,\n          itemErrorSchema = props.itemErrorSchema,\n          autofocus = props.autofocus,\n          onBlur = props.onBlur,\n          onFocus = props.onFocus,\n          rawErrors = props.rawErrors;\n      var _this$props9 = this.props,\n          disabled = _this$props9.disabled,\n          readonly = _this$props9.readonly,\n          uiSchema = _this$props9.uiSchema,\n          _this$props9$registry = _this$props9.registry,\n          registry = _this$props9$registry === void 0 ? (0, _utils.getDefaultRegistry)() : _this$props9$registry;\n      var SchemaField = registry.fields.SchemaField;\n\n      var _orderable$removable$ = (0, _objectSpread3[\"default\"])({\n        orderable: true,\n        removable: true\n      }, uiSchema[\"ui:options\"]),\n          orderable = _orderable$removable$.orderable,\n          removable = _orderable$removable$.removable;\n\n      var has = {\n        moveUp: orderable && canMoveUp,\n        moveDown: orderable && canMoveDown,\n        remove: removable && canRemove\n      };\n      has.toolbar = (0, _keys[\"default\"])(has).some(function (key) {\n        return has[key];\n      });\n      return {\n        children: _react[\"default\"].createElement(SchemaField, {\n          schema: itemSchema,\n          uiSchema: itemUiSchema,\n          formData: itemData,\n          errorSchema: itemErrorSchema,\n          idSchema: itemIdSchema,\n          required: this.isItemRequired(itemSchema),\n          onChange: this.onChangeForIndex(index),\n          onBlur: onBlur,\n          onFocus: onFocus,\n          registry: this.props.registry,\n          disabled: this.props.disabled,\n          readonly: this.props.readonly,\n          autofocus: autofocus,\n          rawErrors: rawErrors\n        }),\n        className: \"array-item\",\n        disabled: disabled,\n        hasToolbar: has.toolbar,\n        hasMoveUp: has.moveUp,\n        hasMoveDown: has.moveDown,\n        hasRemove: has.remove,\n        index: index,\n        key: key,\n        onAddIndexClick: this.onAddIndexClick,\n        onDropIndexClick: this.onDropIndexClick,\n        onReorderClick: this.onReorderClick,\n        readonly: readonly\n      };\n    }\n  }, {\n    key: \"itemTitle\",\n    get: function get() {\n      var schema = this.props.schema;\n      return schema.items.title || schema.items.description || \"Item\";\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(nextProps, prevState) {\n      var nextFormData = nextProps.formData;\n      var previousKeyedFormData = prevState.keyedFormData;\n      var newKeyedFormData = nextFormData.length === previousKeyedFormData.length ? previousKeyedFormData.map(function (previousKeyedFormDatum, index) {\n        return {\n          key: previousKeyedFormDatum.key,\n          item: nextFormData[index]\n        };\n      }) : generateKeyedFormData(nextFormData);\n      return {\n        keyedFormData: newKeyedFormData\n      };\n    }\n  }]);\n  return ArrayField;\n}(_react.Component);\n\n(0, _defineProperty2[\"default\"])(ArrayField, \"defaultProps\", {\n  uiSchema: {},\n  formData: [],\n  idSchema: {},\n  required: false,\n  disabled: false,\n  readonly: false,\n  autofocus: false\n});\n\nif (process.env.NODE_ENV !== \"production\") {\n  ArrayField.propTypes = types.fieldProps;\n}\n\n(0, _reactLifecyclesCompat.polyfill)(ArrayField);\nvar _default = ArrayField;\nexports[\"default\"] = _default;","map":null,"metadata":{},"sourceType":"script"}